-- Retail Business Performance Analysis

-- 1. Check for missing values
SELECT *
FROM retail_data
WHERE Sales IS NULL OR Profit IS NULL;

-- 2. Category-wise Sales and Profit
SELECT 
    Category,
    SUM(Sales) AS Total_Sales,
    SUM(Profit) AS Total_Profit,
    (SUM(Profit) / SUM(Sales)) * 100 AS Profit_Margin
FROM retail_data
GROUP BY Category;

-- 3. Sub-Category Profit Analysis
SELECT 
    Sub_Category,
    SUM(Sales) AS Total_Sales,
    SUM(Profit) AS Total_Profit
FROM retail_data
GROUP BY Sub_Category
ORDER BY Total_Profit ASC;

-- 4. Monthly Sales Trend
SELECT 
    YEAR(Order_Date) AS Year,
    MONTH(Order_Date) AS Month,
    SUM(Sales) AS Monthly_Sales
FROM retail_data
GROUP BY Year, Month
ORDER BY Year, Month;
